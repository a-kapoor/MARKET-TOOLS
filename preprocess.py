import argparse

parser = argparse.ArgumentParser(description='Create Configuration')
parser.add_argument('--file-name', type=str, help='optional filename', 
       default="defaultFile.json")
parser.add_argument('-o', '--output', help='output name', type=str)

args = parser.parse_args()

import pandas as pd
df=pd.read_csv(args.file_name)  

df['Dates'] = pd.to_datetime(df['date']).dt.date
df['Time'] = pd.to_datetime(df['date']).dt.time
df['Hour'] = pd.to_datetime(df['date']).dt.hour
df['Month'] = pd.to_datetime(df['date']).dt.month

df_p=df[['Dates','Time','close','open','high','low']]

df_pnew = df_p.groupby(['Dates']).agg(tuple).applymap(list).reset_index()

split_df = pd.DataFrame(df_pnew['close'].tolist())

dfnew = pd.concat([df_pnew['Dates'], split_df], axis=1)

split_df_high = pd.DataFrame(df_pnew['high'].tolist())
dfnew_high = pd.concat([df_pnew['Dates'], split_df_high], axis=1)
dfnew_high = dfnew_high.add_suffix('_high')

split_df_low = pd.DataFrame(df_pnew['low'].tolist())
dfnew_low = pd.concat([df_pnew['Dates'], split_df_low], axis=1)
dfnew_low = dfnew_low.add_suffix('_low')

df_high_low=dfnew_low.join(dfnew_high)

df_high_low=df_high_low[['Dates_low','0_low', '0_high', '1_low', '1_high', '2_low', '2_high', '3_low', '3_high', '4_low', '4_high', '5_low', '5_high', '6_low', '6_high', '7_low', '7_high', '8_low', '8_high', '9_low', '9_high', '10_low', '10_high', '11_low', '11_high', '12_low', '12_high', '13_low', '13_high', '14_low', '14_high', '15_low', '15_high', '16_low', '16_high', '17_low', '17_high', '18_low', '18_high', '19_low', '19_high', '20_low', '20_high', '21_low', '21_high', '22_low', '22_high', '23_low', '23_high', '24_low', '24_high', '25_low', '25_high', '26_low', '26_high', '27_low', '27_high', '28_low', '28_high', '29_low', '29_high', '30_low', '30_high', '31_low', '31_high', '32_low', '32_high', '33_low', '33_high', '34_low', '34_high', '35_low', '35_high', '36_low', '36_high', '37_low', '37_high', '38_low', '38_high', '39_low', '39_high', '40_low', '40_high', '41_low', '41_high', '42_low', '42_high', '43_low', '43_high', '44_low', '44_high', '45_low', '45_high', '46_low', '46_high', '47_low', '47_high', '48_low', '48_high', '49_low', '49_high', '50_low', '50_high', '51_low', '51_high', '52_low', '52_high', '53_low', '53_high', '54_low', '54_high', '55_low', '55_high', '56_low', '56_high', '57_low', '57_high', '58_low', '58_high', '59_low', '59_high', '60_low', '60_high', '61_low', '61_high', '62_low', '62_high', '63_low', '63_high', '64_low', '64_high', '65_low', '65_high', '66_low', '66_high', '67_low', '67_high', '68_low', '68_high', '69_low', '69_high', '70_low', '70_high', '71_low', '71_high', '72_low', '72_high', '73_low', '73_high', '74_low', '74_high', '75_low', '75_high', '76_low', '76_high', '77_low', '77_high', '78_low', '78_high', '79_low', '79_high', '80_low', '80_high', '81_low', '81_high', '82_low', '82_high', '83_low', '83_high', '84_low', '84_high', '85_low', '85_high', '86_low', '86_high', '87_low', '87_high', '88_low', '88_high', '89_low', '89_high', '90_low', '90_high', '91_low', '91_high', '92_low', '92_high', '93_low', '93_high', '94_low', '94_high', '95_low', '95_high', '96_low', '96_high', '97_low', '97_high', '98_low', '98_high', '99_low', '99_high', '100_low', '100_high', '101_low', '101_high', '102_low', '102_high', '103_low', '103_high', '104_low', '104_high', '105_low', '105_high', '106_low', '106_high', '107_low', '107_high', '108_low', '108_high', '109_low', '109_high', '110_low', '110_high', '111_low', '111_high', '112_low', '112_high', '113_low', '113_high', '114_low', '114_high', '115_low', '115_high', '116_low', '116_high', '117_low', '117_high', '118_low', '118_high', '119_low', '119_high', '120_low', '120_high', '121_low', '121_high', '122_low', '122_high', '123_low', '123_high', '124_low', '124_high', '125_low', '125_high', '126_low', '126_high', '127_low', '127_high', '128_low', '128_high', '129_low', '129_high', '130_low', '130_high', '131_low', '131_high', '132_low', '132_high', '133_low', '133_high', '134_low', '134_high', '135_low', '135_high', '136_low', '136_high', '137_low', '137_high', '138_low', '138_high', '139_low', '139_high', '140_low', '140_high', '141_low', '141_high', '142_low', '142_high', '143_low', '143_high', '144_low', '144_high', '145_low', '145_high', '146_low', '146_high', '147_low', '147_high', '148_low', '148_high', '149_low', '149_high', '150_low', '150_high', '151_low', '151_high', '152_low', '152_high', '153_low', '153_high', '154_low', '154_high', '155_low', '155_high', '156_low', '156_high', '157_low', '157_high', '158_low', '158_high', '159_low', '159_high', '160_low', '160_high', '161_low', '161_high', '162_low', '162_high', '163_low', '163_high', '164_low', '164_high', '165_low', '165_high', '166_low', '166_high', '167_low', '167_high', '168_low', '168_high', '169_low', '169_high', '170_low', '170_high', '171_low', '171_high', '172_low', '172_high', '173_low', '173_high', '174_low', '174_high', '175_low', '175_high', '176_low', '176_high', '177_low', '177_high', '178_low', '178_high', '179_low', '179_high', '180_low', '180_high', '181_low', '181_high', '182_low', '182_high', '183_low', '183_high', '184_low', '184_high', '185_low', '185_high', '186_low', '186_high', '187_low', '187_high', '188_low', '188_high', '189_low', '189_high', '190_low', '190_high', '191_low', '191_high', '192_low', '192_high', '193_low', '193_high', '194_low', '194_high', '195_low', '195_high', '196_low', '196_high', '197_low', '197_high', '198_low', '198_high', '199_low', '199_high', '200_low', '200_high', '201_low', '201_high', '202_low', '202_high', '203_low', '203_high', '204_low', '204_high', '205_low', '205_high', '206_low', '206_high', '207_low', '207_high', '208_low', '208_high', '209_low', '209_high', '210_low', '210_high', '211_low', '211_high', '212_low', '212_high', '213_low', '213_high', '214_low', '214_high', '215_low', '215_high', '216_low', '216_high', '217_low', '217_high', '218_low', '218_high', '219_low', '219_high', '220_low', '220_high', '221_low', '221_high', '222_low', '222_high', '223_low', '223_high', '224_low', '224_high', '225_low', '225_high', '226_low', '226_high', '227_low', '227_high', '228_low', '228_high', '229_low', '229_high', '230_low', '230_high', '231_low', '231_high', '232_low', '232_high', '233_low', '233_high', '234_low', '234_high', '235_low', '235_high', '236_low', '236_high', '237_low', '237_high', '238_low', '238_high', '239_low', '239_high', '240_low', '240_high', '241_low', '241_high', '242_low', '242_high', '243_low', '243_high', '244_low', '244_high', '245_low', '245_high', '246_low', '246_high', '247_low', '247_high', '248_low', '248_high', '249_low', '249_high', '250_low', '250_high', '251_low', '251_high', '252_low', '252_high', '253_low', '253_high', '254_low', '254_high', '255_low', '255_high', '256_low', '256_high', '257_low', '257_high', '258_low', '258_high', '259_low', '259_high', '260_low', '260_high', '261_low', '261_high', '262_low', '262_high', '263_low', '263_high', '264_low', '264_high', '265_low', '265_high', '266_low', '266_high', '267_low', '267_high', '268_low', '268_high', '269_low', '269_high', '270_low', '270_high', '271_low', '271_high', '272_low', '272_high', '273_low', '273_high', '274_low', '274_high', '275_low', '275_high', '276_low', '276_high', '277_low', '277_high', '278_low', '278_high', '279_low', '279_high', '280_low', '280_high', '281_low', '281_high', '282_low', '282_high', '283_low', '283_high', '284_low', '284_high', '285_low', '285_high', '286_low', '286_high', '287_low', '287_high', '288_low', '288_high', '289_low', '289_high', '290_low', '290_high', '291_low', '291_high', '292_low', '292_high', '293_low', '293_high', '294_low', '294_high', '295_low', '295_high', '296_low', '296_high', '297_low', '297_high', '298_low', '298_high', '299_low', '299_high', '300_low', '300_high', '301_low', '301_high', '302_low', '302_high', '303_low', '303_high', '304_low', '304_high', '305_low', '305_high', '306_low', '306_high', '307_low', '307_high', '308_low', '308_high', '309_low', '309_high', '310_low', '310_high', '311_low', '311_high', '312_low', '312_high', '313_low', '313_high', '314_low', '314_high', '315_low', '315_high', '316_low', '316_high', '317_low', '317_high', '318_low', '318_high', '319_low', '319_high', '320_low', '320_high', '321_low', '321_high', '322_low', '322_high', '323_low', '323_high', '324_low', '324_high', '325_low', '325_high', '326_low', '326_high', '327_low', '327_high', '328_low', '328_high', '329_low', '329_high', '330_low', '330_high', '331_low', '331_high', '332_low', '332_high', '333_low', '333_high', '334_low', '334_high', '335_low', '335_high', '336_low', '336_high', '337_low', '337_high', '338_low', '338_high', '339_low', '339_high', '340_low', '340_high', '341_low', '341_high', '342_low', '342_high', '343_low', '343_high', '344_low', '344_high', '345_low', '345_high', '346_low', '346_high', '347_low', '347_high', '348_low', '348_high', '349_low', '349_high', '350_low', '350_high', '351_low', '351_high', '352_low', '352_high', '353_low', '353_high', '354_low', '354_high', '355_low', '355_high', '356_low', '356_high', '357_low', '357_high', '358_low', '358_high', '359_low', '359_high', '360_low', '360_high', '361_low', '361_high', '362_low', '362_high', '363_low', '363_high', '364_low', '364_high', '365_low', '365_high', '366_low', '366_high', '367_low', '367_high', '368_low', '368_high', '369_low', '369_high', '370_low', '370_high', '371_low', '371_high', '372_low', '372_high', '373_low', '373_high', '374_low', '374_high']]
df_high_low=df_high_low.rename(columns={'Dates_low': 'Dates'})

df_high_low.to_csv(args.output)




